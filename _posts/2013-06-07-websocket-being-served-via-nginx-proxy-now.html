---
layout: post
status: publish
published: true
title: WebSocket Being Served Via NginX Proxy Now
author:
  display_name: Le Quoc Viet
  login: admin
  email: vietlq85@gmail.com
  url: http://simpleit.us
author_login: admin
author_email: vietlq85@gmail.com
author_url: http://simpleit.us
wordpress_id: 195
wordpress_url: http://blog.simpleit.us/?p=195
date: '2013-06-07 08:56:38 +0000'
date_gmt: '2013-06-07 00:56:38 +0000'
categories:
- web
- development
- tips
tags: []
comments: []
---
<p>The NginX server from the Ubuntu LTS repo was 1.1.x and did not support WebSockets. The minimum version of NginX that supports WebSockets is 1.3.13. Note that supports comes in the proxy module. I upgraded to 1.4.1 by compiling from source and the proxy module is enabled by default. Now you can taste WebSockets via NginX proxy at <a title="Pico App" href="http://pico.simpleit.us/">http://pico.simpleit.us/</a> . Only valid users can log in and fully experience it. If you want to test our new app, comment below.</p>
<p>The WebSocket proxy configuration I used:</p>
<pre>server {<br />
    listen 80;<br />
    root /var/www/pico.simpleit.us;</p>
<p>    server_name pico.simpleit.us;</p>
<p>    location / {<br />
        proxy_pass http://localhost:3000;<br />
        proxy_http_version 1.1;<br />
        proxy_set_header Upgrade $http_upgrade;<br />
        proxy_set_header Connection "upgrade";<br />
        proxy_set_header Host $host;<br />
    }<br />
}</pre><br />
For the curious, here are the configuration flags I used to compile NginX 1.4.1 (remember to install ssl dev packages)</p>
<pre>./configure --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --prefix=/usr --pid-path=/run/nginx.pid --error-log-path=/var/log/nginx/error.log --with-openssl=/usr/lib/ssl</pre><br />
<strong>References:</strong></p>
<p><a title="https://chrislea.com/2013/02/23/proxying-websockets-with-nginx/" href="https://chrislea.com/2013/02/23/proxying-websockets-with-nginx/">https://chrislea.com/2013/02/23/proxying-websockets-with-nginx/</a></p>
<p><a title="http://stackoverflow.com/questions/16469581/nginx-and-proxying-websockets" href="http://stackoverflow.com/questions/16469581/nginx-and-proxying-websockets">http://stackoverflow.com/questions/16469581/nginx-and-proxying-websockets</a></p>
