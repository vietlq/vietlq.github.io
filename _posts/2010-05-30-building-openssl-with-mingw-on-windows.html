---
layout: post
status: publish
published: true
title: Building OpenSSL with MinGW on Windows
author:
  display_name: Le Quoc Viet
  login: admin
  email: vietlq85@gmail.com
  url: http://simpleit.us
author_login: admin
author_email: vietlq85@gmail.com
author_url: http://simpleit.us
wordpress_id: 102
wordpress_url: http://blog.simpleit.us/?p=102
date: '2010-05-30 13:42:45 +0000'
date_gmt: '2010-05-30 05:42:45 +0000'
categories:
- tutorial
tags:
- windows
- openssl
- mingw
comments:
- id: 191
  author: Enabling OpenSSL for Qt C++ on Windows &laquo; SimpleIT
  author_email: ''
  author_url: http://blog.simpleit.us/2010/05/30/enabling-openssl-for-qt-c-on-windows/
  date: '2010-05-30 14:35:52 +0000'
  date_gmt: '2010-05-30 06:35:52 +0000'
  content: "[...] you have read http://blog.simpleit.us/2010/05/30/installing-qt-qtcreator-and-mingw-for-windows/
    and http://blog.simpleit.us/2010/05/30/building-openssl-with-mingw-on-windows/
    before [...]"
- id: 1565
  author: Rui Fernandes
  author_email: rui.kepler@gmail.com
  author_url: ''
  date: '2011-02-16 22:46:34 +0000'
  date_gmt: '2011-02-16 14:46:34 +0000'
  content: "Hi,\r\n\r\nAfter the compilation, I do we include the OpenSSL library
    in the C scripts - using MinGW? For example the header file bn.h?\r\nThere's also
    a version for windows 32 of OpenSSL; can we use it instead?\r\nBut how do we call
    the header files? Where do we place the library?\r\n\r\nKind regards,\r\n\r\nRui
    Fernandes"
- id: 10254
  author: Josef Stadelmann
  author_email: josef.stadelmann@axa-winterthur.ch
  author_url: ''
  date: '2012-05-10 22:58:30 +0000'
  date_gmt: '2012-05-10 14:58:30 +0000'
  content: "I got an error during the build\r\n\r\nBuilding OpenSSL\r\ncopy \".\\\\e_os.h\"
    \"tmp\\e_os.h\"\r\n/usr/bin/sh: copy: command not found\r\nmingw32-make:
    *** [tmp\\e_os.h] Error 127\r\n\r\nI think the error is in the generated mingw32a.mak\r\n.
    . . .\r\nvclean:\r\n\t$(RM) $(TMP_D)\\*.*\r\n\t$(RM) $(OUT_D)\\*.*\r\n\r\n$(INCL_D)\\e_os.h:
    $(SRC_D)\\\\e_os.h\r\n\t$(CP) \"$(SRC_D)\\\\e_os.h\" \"$(INCL_D)\\e_os.h\"\r\n\r\n$(INCL_D)\\cryptlib.h:
    $(SRC_D)\\\\cryptlib.h\r\n\t$(CP) \"$(SRC_D)\\\\cryptlib.h\" \"$(INCL_D)\\cryptlib.h\"\r\n\r\nthe
    copy command is wrong generated\r\nit should consist of 3 items separated by space\r\nbut
    is generated into mingw32a.mak as\r\n$(CP) \"$(SRC_D)\\\\e_os.h\" \"$(INCL_D)\\e_os.h\"\r\nresulting
    in\r\ncopy \".\\\\e_os.h\" \"tmp\\e_os.h\"\r\nwhich is wrong\r\n\r\nJosef.Stadelmann"
- id: 13281
  author: Darrell Walisser
  author_email: darrell.walisser@gmail.com
  author_url: ''
  date: '2012-11-15 01:29:00 +0000'
  date_gmt: '2012-11-14 17:29:00 +0000'
  content: It should be noted that the msys perl interpreter (/bin/perl.exe)
    will create the wrong copy command as noted above. ActiveState perl will solve
    the issue.
- id: 16373
  author: Le Quoc Viet
  author_email: viet.aikidorb@gmail.com
  author_url: http://simpleit.us
  date: '2013-05-28 08:26:15 +0000'
  date_gmt: '2013-05-28 00:26:15 +0000'
  content: Thanks Darrell! Noted :D
---
<p>A number of libraries applications depend on OpenSSL, to name a few: cURL, QtNetwork, WebKit, your IMAP or secure SMTP client, etc. Building of OpenSSL is painstaking, unless you know some tricks. Read more for guidance.</p>
<ol>
<li>If you yet to have MinGW, read to learn how to install it.</li>
<li>Download Perl from ActiveState site: . Choose version that match your Windows. MSI installer is recommended, unless you are so fluent in Windows and don't mind spending time with little tweaks like adding PATH, etc</li>
<li>Run the MSI installer and point path to C:\develop\tools\perl . You may choose different path, but that's what on my machine.</li>
<li>Having installed with Perl, now let's fetch OpenSSL: (the latest version of OpenSSL 0.9.8 at the time of writing).  I wouldn't recommend chasing after the version 1.0 for now.</li>
<li>Extract openssl to C:\develop\tools\ and you will obtain directory C:\develop\tools\openssl-0.9.8n . Get inside it.</li>
<li>Before you start building anything, take note that the macro OPENSSL_IMPLEMENT_GLOBAL causes fatal errors. Find it inside the files openssl-0.9.8n\e_os2.h , openssl-0.9.8n\include\openssl\e_os2.h and openssl-0.9.8n\outinc\openssl\e_os2.h . Find the macro's definition and change</li><br />
<br />
{% highlight c %}static type _hide_##name{% endhighlight %}</p>
<p>to</p>
<p>{% highlight c %}/* static type _hide_##name */ type _hide_##name{% endhighlight %}</p>

<li>Now let's build shared &amp; static versions of OpenSSL with a single command (you are now inside C:\develop\tools\openssl-0.9.8n):</li><br />
<br />
ms\mingw32.bat shared</p>
<p>Navigate to YouTube and have some snack. It may take 15-20 mins to finish building.</p>
<li>When building is finished, you can copy outinc\openssl to your mingw\include directory. You also can copy generated *.a and *.dll files to mingw\lib directory and the *.dll to mingw\bin directory. If you hate copying, remember to make use of -I and -L flags to appropriate folders when building with MinGW.</li><br />
</ol><br />
Building &amp; installation of OpenSSL is done.</p>
<p><strong>Edit:</strong> As noted by Darrell Walisser in the comments part, Perl distributed with msys was the culprit. Installing ActiveState Perl will solve the issue without this workaround. Thanks Darrell!</p>
<p>References:</p>
<p>[1]</p>
