---
layout: post
status: publish
published: true
title: How I picked up TDD & Google Test in a few hours
author:
  display_name: Le Quoc Viet
  login: admin
  email: vietlq85@gmail.com
  url: http://simpleit.us
author_login: admin
author_email: vietlq85@gmail.com
author_url: http://simpleit.us
wordpress_id: 204
wordpress_url: http://blog.simpleit.us/?p=204
date: '2013-06-08 20:58:01 +0000'
date_gmt: '2013-06-08 12:58:01 +0000'
categories:
- c++
- tools
- development
- tips
tags: []
comments: []
---
<p>[caption id="attachment_205" align="aligncenter" width="287"]<a href="http://blog.simpleit.us/wp-content/uploads/2013/06/tdd.gif"><img class="size-medium wp-image-205" alt="TDD Diagram" src="http://blog.simpleit.us/wp-content/uploads/2013/06/tdd-287x300.gif" width="287" height="300" /></a> TDD Diagram[/caption]</p>
<p>To confess, this is the first time I write unit testing for Java &amp; C++ and it turned out this was rather simple. This weekend Daniel is hosting hackathon at his place and invited Kong &amp; me to come over. The first thing we did was TDD. Daniel was fluent in TDD &amp; pair-programming as his company used Ruby and actively worshiped agile development.</p>
<p>I was given a task: To implement a set data structure in Java as simple as possible to pass the test cases that he would write to challenge the implementation. The first test case was to assert emptiness of a new set via the method `bool isEmpty`. Returning `true` was easy. Then Daniel wrote another task to add a new element and requested the set must return `false`. I added a count &amp; array as private data members. Daniel said I should implement as simple as possible. So I used private one member _isEmpty and set it to `true` by default and `false` when invoking `add(int value)`.</p>
<p>And we went on to add test cases to cover methods `int count()`, `void remove(int value)`, `int getIndexOf(int value)`... I got 2 bugs and JUnit was able to point out which test cases failed and I was able to locate the bugs with ease.</p>
<p>I got excited and then moved to C++ and installed <a title="Google Test framework" href="https://code.google.com/p/googletest/wiki/V1_6_Primer">Google Test framework</a>. It was too simple and I regret not using it earlier. Read my TDD C++ code <a title="https://github.com/vietlq/cpp/tree/master/tdd_set" href="https://github.com/vietlq/cpp/tree/master/tdd_set">https://github.com/vietlq/cpp/tree/master/tdd_set</a>, you will find it super simple. Here's the screenshot of the test program:</p>
<p><a href="http://blog.simpleit.us/wp-content/uploads/2013/06/Screen-Shot-2013-06-08-at-8.10.16-PM.png"><img class="aligncenter size-medium wp-image-210" alt="Passed All Test Cases (Using Google Test)" src="http://blog.simpleit.us/wp-content/uploads/2013/06/Screen-Shot-2013-06-08-at-8.10.16-PM-300x238.png" width="300" height="238" /></a></p>
<p>The real value is seen when refactoring was involved in the process. TDD approach &amp; the written test cases greatly aided me in verifying that code refactoring worked like the old code. When it comes to real life projects with hundeds of modules and millions of lines of code, refactoring without test coverage is like walking into a minefield. If you were diligent enough to write test cases to cover all functions and methods, then you can refactor at will and then run against the accumulated test cases with confidence.</p>
<p>However, one must be clear that test cases guarantee only the cases they cover. Passing the refactored code against the test cases doesn't guarantee correct outcomes of untested cases. So, be diligent and creative enough to write quality test cases to cover all possible cases to exactly define the behavior of the functions &amp; methods.</p>
<p>Lastly, TDD enforces no optimization. TDD requires you to write simplest possible code to pass all the test cases. Refactor along the way and pass the test cases. Profile when you need performance. That's not to downplay the importance of throughout &amp; mindful design of algorithms and data structures. One must find a good balance between TDD &amp; efficient implementation that is crafted since the very beginning, not leaving refactoring to the very late stage.</p>
<p><strong>Edit:</strong> If the above C++ Set example is oversimplified for you, follow its sibling WordPath <a title="WordPath Game - Find optimal way to transform a word to another with 1 character being changed per move" href="https://github.com/vietlq/cpp/tree/master/WordPath">https://github.com/vietlq/cpp/tree/master/WordPath</a></p>
